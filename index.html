<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>L'Archipel des Insectes - Exploration Éducative</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@300;400;700&family=Open+Sans:wght@300;400;600&display=swap" rel="stylesheet" />

    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>
    <script src="https://cdn.babylonjs.com/gui/babylon.gui.min.js"></script>
    <script src="https://cdn.babylonjs.com/materials/babylonjs.materials.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/main.css" />
</head>
<body>

<button class="btn-help-floating" onclick="UIManager.toggleGlobalHelp()" aria-label="Aide">
    <i class="fas fa-question"></i>
</button>

<div id="global-help-modal" class="global-help-modal">
    <div class="help-content">
        <button class="nav-close" onclick="UIManager.toggleGlobalHelp()">×</button>

        <div class="help-header">
            <h2>Guide de l'Explorateur</h2>
            <p>Bienvenue dans l'Archipel. Voici comment mener votre mission à bien.</p>
        </div>

        <div class="help-grid">
            <div class="help-card">
                <div class="help-icon"><i class="fas fa-mouse-pointer"></i></div>
                <h3>Navigation 3D</h3>
                <p><strong>Maintenez le clic gauche</strong> pour tourner autour de l'archipel. Utilisez la <strong>molette</strong> pour zoomer/dézoomer.</p>
            </div>

            <div class="help-card">
                <div class="help-icon"><i class="fas fa-anchor"></i></div>
                <h3>Le Port d'Attache</h3>
                <p>C'est votre hub central. Cliquez sur le <strong>Port ou le Bateau</strong> pour choisir une île et lancer une expédition.</p>
            </div>

            <div class="help-card">
                <div class="help-icon"><i class="fas fa-chart-pie"></i></div>
                <h3>Exploration</h3>
                <p>Survolez les îles pour voir votre progression. Chaque île possède un écosystème unique et des espèces à découvrir.</p>
            </div>

            <div class="help-card">
                <div class="help-icon"><i class="fas fa-book-journal-whills"></i></div>
                <h3>Carnet de Bord</h3>
                <p>Toutes vos découvertes sont enregistrées. Consultez-le via le bouton en bas à gauche pour revoir vos fiches.</p>
            </div>
        </div>

        <button class="btn-primary" style="margin-top: 30px;" onclick="UIManager.toggleGlobalHelp()">
            J'ai compris, à l'aventure !
        </button>
    </div>
</div>

<div id="navigation-modal" class="navigation-modal">
    <div class="nav-content">
        <button class="nav-close" onclick="UIManager.closeNavigation()">×</button>
        <h2>Plan de Navigation</h2>
        <p>Capitaine, quelle est notre prochaine destination ?</p>

        <div class="destinations-grid" id="destinations-grid">
        </div>
    </div>
</div>

<div id="map-view-screen" class="screen active">
    <canvas id="renderCanvas"></canvas>

    <div class="map-top-bar">
        <div class="map-titles">
            <h1 class="map-title">Archipel de la Biodiversité</h1>
        </div>
    </div>

    <div class="map-left-ui-stack">

        <button class="btn-journal-map" onclick="ArchipelagoApp.openJournalFromMap()">
            Consulter le Carnet de Bord
        </button>

        <div class="map-mission-panel">
            <div class="mission-header">
                <h4>Votre Mission</h4>
            </div>
            <p>L'équilibre de l'archipel est menacé. Explorez chaque île pour documenter les espèces clés et comprendre leur rôle dans l'écosystème.
                Chaque espèce découverte sera répertoriée dans votre carnet de bord.
            </p>
            <ul class="mission-steps">
                <li><i class="fas fa-compass"></i> <strong>Naviguez</strong> vers une île pour l'étudier.</li>
                <li><i class="fas fa-magnifying-glass"></i> <strong>Identifiez</strong> les insectes cachés.</li>
                <li><i class="fas fa-book-open"></i> <strong>Complétez</strong> votre base de données.</li>
            </ul>
        </div>
    </div>

    <div class="map-ui-bottom">
        <div class="island-legend">
            <div class="legend-item">
                <span class="legend-color" style="background: #7cb342"></span>
                <span>Zone saine</span>
            </div>
            <div class="legend-item">
                <span class="legend-color" style="background: #ffa726"></span>
                <span>Étude en cours</span>
            </div>
            <div class="legend-item">
                <span class="legend-color" style="background: #42a5f5"></span>
                <span>Inventaire terminé</span>
            </div>
        </div>
    </div>

    <div id="island-tooltip" class="island-tooltip">
    </div>
</div>

<div id="boat-travel-screen" class="screen">
    <canvas id="boatCanvas"></canvas>

    <div class="travel-overlay">
        <div class="travel-message">
            <h2 id="travel-text">Cap vers l'île...</h2>

            <p id="travel-quote" class="travel-quote">Chargement des données...</p>

            <div class="wave-animation"></div>
        </div>
    </div>
</div>

<div id="island-exploration-screen" class="screen">
    <canvas id="islandCanvas"></canvas>

    <div id="left-panel" class="side-panel left-panel">
        <div class="panel-header">
            <h3 class="panel-title" id="island-name">Nom de l'île</h3>
            <p class="panel-ecosystem" id="island-ecosystem">Écosystème</p>
        </div>

        <div class="info-section env-container">
            <h4>Analyse du Biome</h4>
            <p id="island-env-desc" class="educational-text">Chargement des données environnementales...</p>
        </div>

        <div class="progress-section">
            <h4>Registre d'Exploration</h4>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
            <p class="progress-text" id="progress-text">0/0 spécimens identifiés</p>
        </div>

        <div class="panel-actions">
            <button class="btn-primary" onclick="ArchipelagoApp.openJournal()">
                Ouvrir le Carnet
            </button>
            <button class="btn-secondary" onclick="ArchipelagoApp.returnToMap()">
                Retour à la carte
            </button>
        </div>
    </div>

    <div id="right-panel" class="side-panel right-panel">
        <button class="panel-close" onclick="ArchipelagoApp.closeInsectPanel()">×</button>

        <div class="insect-header">
            <h3 class="insect-name" id="insect-name">Nom Insecte</h3>
            <div class="insect-meta">
                <p id="insect-scientific" class="scientific-name">Nom latin</p>
                <p id="insect-taxonomy" class="taxonomy-info">Classification</p>
            </div>
        </div>

        <div class="insect-model-preview" id="insect-preview">
            <div class="model-placeholder">?</div>
        </div>

        <div class="insect-info-scroll">
            <div class="info-section">
                <h4>Rôle Écologique</h4>
                <p id="insect-role" class="educational-text">...</p>
            </div>

            <div class="info-section">
                <h4>Habitat Spécifique</h4>
                <p id="insect-habitat" class="educational-text">...</p>
            </div>

            <div class="info-section">
                <h4>Note du Naturaliste</h4>
                <p id="insect-anecdote" class="educational-text italic">...</p>
            </div>

            <div class="status-badge" id="insect-status">
                <span>Statut de conservation</span>
            </div>
        </div>
    </div>

    <div class="help-overlay" id="help-overlay">
        <p>Explorez l'île et cliquez sur les insectes pour les découvrir puis les ajouter à votre carnet de bord.</p>
    </div>
</div>

<div id="journal-screen" class="screen">
    <div class="journal-container">
        <button class="journal-close" onclick="ArchipelagoApp.closeJournal()">×</button>

        <h2 class="journal-title">Carnet de Bord Scientifique</h2>
        <p class="journal-subtitle">Base de données des arthropodes découverts</p>

        <div class="journal-grid" id="journal-grid"></div>

        <div class="journal-stats">
            <p><strong>Spécimens collectés :</strong> <span id="total-discovered">0</span> / <span id="total-insects">20</span></p>
            <p><strong>Biomes cartographiés :</strong> <span id="islands-explored">0</span> / 5</p>
        </div>
    </div>

    <div class="journal-modal" id="journal-modal">
        <div class="modal-content">
            <button class="journal-close" onclick="JournalManager.closeModal()">×</button>

            <div class="modal-visual">
                <div id="journal-3d-container" style="width:100%; height:100%"></div>
            </div>

            <div class="modal-data">
                <h2 class="panel-title" id="modal-name">Nom</h2>
                <p class="modal-taxonomy" id="modal-taxonomy">Taxonomie</p>
            </div>
        </div>
    </div>
</div>

<div id="conclusion-screen" class="screen">
    <div class="conclusion-content">
        <h2 class="conclusion-title">Mission Accomplie</h2>
        <p class="conclusion-message">
            Vous avez parcouru l'archipel et documenté la vie de ses plus petits habitants.
            Votre carnet de bord est désormais une ressource précieuse pour la protection de ces écosystèmes fragiles.
        </p>

        <div class="conclusion-stats">
            <div class="stat-item">
                <span class="stat-number" id="final-insects">20</span>
                <span class="stat-label">Identifications</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="final-islands">5</span>
                <span class="stat-label">Îles explorées</span>
            </div>
        </div>

        <button class="btn-primary" onclick="ArchipelagoApp.restart()">
            Nouvelle Expédition
        </button>
    </div>
</div>

<script src="js/config.js"></script>
<script src="js/data-islands.js"></script>
<script src="js/ui-manager.js"></script>
<script src="js/journal.js"></script>
<script src="js/scene-map.js"></script>
<script src="js/scene-boat.js"></script>
<script src="js/scene-island.js"></script>
<script src="js/app.js"></script>
</body>
</html>